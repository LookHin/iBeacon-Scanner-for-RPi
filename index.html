<html>
<head>
	<title>iBeaconScanner</title>
</head>
<body>
	<header>
		<p> # of Beacons: <span id="beaconcount">0</span></p>
		<button id="startscan">Start Scan</button>
		<button id="stopscan">Stop Scan</button>
	</header>
	<ul id="beaconlist">


	</ul>
</body>
<script type="text/javascript">
	var getJsonInterval = null;
	function getJson() {
		var blist = document.getElementById('beaconlist');
		fetch('/beacons.json').then(function(data) {
			return data.json();
			//console.log(data);
		}).then(function(json) {
			for (var key in json) {
				var li = document.getElementById(key);
				if(li !== null) {
					li.innerHTML = key + " --- " + json[key].major;
				} else {
					li = document.createElement('li');
					li.setAttribute('id',key);
					li.innerHTML = key + " --- " + json[key].major;
					blist.appendChild(li);
				}
			}
		});
		setTimeout(getJson,1000);
	}

	var startBtn = document.getElementById('startscan');
	var stopBtn = document.getElementById('stopscan');
	startBtn.addEventListener('click',function() {
		console.log('Start Scan');
		getJsonInterval = setInterval(getJson,1000);
	},false);
	stopBtn.addEventListener('click',function() {
		console.log('Stop Scan');
		clearInterval(getJsonInterval);
		getJsonInterval = null;
	});
</script>
</html>
